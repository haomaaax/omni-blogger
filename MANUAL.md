# Blog Editor Manual

A clean, distraction-free blog editor with WYSIWYG interface and one-click publish to your Hugo static site.

---

## Table of Contents

1. [Overview](#overview)
2. [File Structure](#file-structure)
3. [Setup Instructions](#setup-instructions)
4. [Using the Editor](#using-the-editor)
5. [Configuration](#configuration)
6. [How It Works](#how-it-works)
7. [Customization Guide](#customization-guide)
8. [Keyboard Shortcuts](#keyboard-shortcuts)
9. [Troubleshooting](#troubleshooting)
10. [Future Enhancements](#future-enhancements)

---

## Overview

This is a local web application that provides:

- **WYSIWYG Editor**: Write like in Google Docsâ€”no Markdown knowledge needed
- **Auto-save**: Drafts saved to browser storage automatically
- **One-click Publish**: Saves to Hugo, builds site, and deploys
- **Dark Mode**: Follows your system preference
- **Minimal Design**: Inspired by Freewriteâ€”focused on writing

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Browser (localhost:3000)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  index.html + style.css + editor.js               â”‚  â”‚
â”‚  â”‚  (WYSIWYG Editor with formatting toolbar)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚                               â”‚
â”‚                          â”‚ POST /publish                 â”‚
â”‚                          â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  server.js (Node.js)                              â”‚  â”‚
â”‚  â”‚  - Receives post content                          â”‚  â”‚
â”‚  â”‚  - Saves .md file to Hugo content/posts/          â”‚  â”‚
â”‚  â”‚  - Runs: hugo --minify                            â”‚  â”‚
â”‚  â”‚  - Runs: deploy command (rsync/etc)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Your Hugo Blog       â”‚
              â”‚  myblog/content/posts â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Your Live Website    â”‚
              â”‚  yourdomain.com       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Structure

### Recommended Setup (Separate Folders)

```
~/projects/                 # Or any parent directory of your choice
â”œâ”€â”€ omni-blogger/           # Editor application
â”‚   â”œâ”€â”€ index.html          # Main HTML file (editor UI)
â”‚   â”œâ”€â”€ style.css           # Styles (dark/light mode, typography)
â”‚   â”œâ”€â”€ editor.js           # Client-side JavaScript (WYSIWYG, HTMLâ†’Markdown)
â”‚   â”œâ”€â”€ server.js           # Node.js server (file saving, Hugo build, deploy)
â”‚   â””â”€â”€ MANUAL.md           # This documentation
â”‚
â””â”€â”€ my-blog/                # Your Hugo blog (separate repo)
    â”œâ”€â”€ content/
    â”‚   â””â”€â”€ posts/          # Published posts go here
    â”œâ”€â”€ themes/
    â”‚   â””â”€â”€ PaperMod/       # Theme files
    â”œâ”€â”€ public/             # Built site (generated by Hugo)
    â””â”€â”€ hugo.toml           # Hugo configuration
```

This separation allows you to:
- Version control the editor and blog separately
- Share the editor tool without exposing your content
- Use one editor for multiple blogs

---

## Setup Instructions

### Prerequisites

1. **Node.js** installed on your Mac
   ```bash
   # Check if installed
   node --version

   # Install via Homebrew if needed
   brew install node
   ```

2. **Hugo** installed
   ```bash
   # Check if installed
   hugo version

   # Install via Homebrew if needed
   brew install hugo
   ```

3. **Git** (for theme installation)
   ```bash
   git --version
   ```

### Step 1: Clone or Download the Editor

Clone this repository or download it to your preferred location:
```bash
# Choose your preferred parent directory
cd ~/projects  # or ~/Documents, ~/code, etc.

git clone <your-repo-url> omni-blogger
cd omni-blogger
```

### Step 2: Create Your Hugo Blog

**Important**: Keep your blog content separate from the editor tool. This allows you to:
- Version control them separately
- Use the same editor for multiple blogs
- Share the editor tool without sharing your content

Create a new Hugo blog as a sibling folder to the editor:

```bash
# Navigate to parent directory
cd ~/projects  # Use the same parent directory where you put omni-blogger

# Create new Hugo site
hugo new site my-blog

# Initialize git and install a theme (example: PaperMod)
cd my-blog
git init
git submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
echo "theme = 'PaperMod'" >> hugo.toml
```

**Recommended folder structure:**
```
~/projects/           # Your chosen parent directory
â”œâ”€â”€ omni-blogger/     # This editor tool
â””â”€â”€ my-blog/          # Your Hugo blog content
```

**Other popular themes:**
- Browse themes at https://themes.gohugo.io/
- PaperMod: `https://github.com/adityatelange/hugo-PaperMod.git`
- Ananke: `https://github.com/theNewDynamic/gohugo-theme-ananke.git`

### Step 3: Configure the Server

Edit `server.js` and update the CONFIG section (around line 14):

```javascript
const CONFIG = {
  port: 3000,

  // âš ï¸ UPDATE THIS to your Hugo blog folder (use absolute path)
  blogPath: '/Users/YOUR_USERNAME/projects/my-blog',

  editorPath: __dirname,

  // âš ï¸ UPDATE THIS for auto-deploy (or set to null for local-only)
  deployCommand: null,  // e.g., './deploy.sh' when ready to deploy
};
```

### Step 4: Configure the Client

Edit `editor.js` and update the CONFIG section (around line 9):

```javascript
const CONFIG = {
  // âš ï¸ UPDATE THIS to your Hugo blog path (use absolute path)
  blogPath: '/Users/YOUR_USERNAME/projects/my-blog',

  // âš ï¸ UPDATE THIS to your blog URL (use localhost:1313 for local preview)
  blogUrl: 'http://localhost:1313',

  apiUrl: 'http://localhost:3000'
};
```

### Step 5: Start the Editor Server

```bash
cd ~/projects/omni-blogger  # Adjust path to where you installed it
node server.js
```

You should see:
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘       ğŸ“ Blog Editor Server            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Open: http://localhost:3000            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Step 6: (Optional) Start Hugo Preview Server

In a **second terminal**, start Hugo's development server to preview your blog:

```bash
cd ~/projects/my-blog  # Adjust to your Hugo blog location
hugo server
```

Your blog preview will be available at **http://localhost:1313**

### Step 7: Start Writing!

Open your browser and go to:
```
http://localhost:3000
```

You're ready to write! When you click **"âœ¨ Publish"**, your posts will automatically:
- Save to `your-blog/content/posts/`
- Trigger a Hugo rebuild with `hugo --minify`
- Appear at http://localhost:1313 (if Hugo server is running)

---

## Using the Editor

### Writing a Post

1. **Enter a title** in the title field
2. **Add tags** (optional) - comma separated like: `thoughts, running, qa`
3. **Write your content** in the main editor area
4. Use the **toolbar** to format text:

| Button | Action |
|--------|--------|
| **B** | Bold text |
| *I* | Italic text |
| H2 | Heading 2 |
| H3 | Heading 3 |
| â€¢ | Bullet list |
| 1. | Numbered list |
| " | Block quote |
| ğŸ”— | Insert link |
| </> | Inline code |

### Saving Drafts

- **Auto-save**: Drafts are saved automatically after 2 seconds of inactivity
- **Manual save**: Click "Save Draft" or press `âŒ˜S`
- **View drafts**: Click "Drafts" button to see all saved drafts

Drafts are stored in your browser's localStorage (not in files).

### Publishing

1. Click the **âœ¨ Publish** button (or press `âŒ˜Enter`)
2. The editor will:
   - Convert your content to Markdown
   - Save to `myblog/content/posts/your-post-title.md`
   - Run `hugo --minify` to build the site
   - Run your deploy command (if configured)
3. A success modal appears with a link to your post

### Offline Mode

If the server isn't running when you click Publish:
- The editor will download the Markdown file
- You can manually move it to your Hugo blog and deploy

---

## Configuration

### Server Configuration (server.js)

```javascript
const CONFIG = {
  // Server port
  port: 3000,

  // Path to your Hugo blog (use absolute path, adjust to your setup)
  blogPath: '/Users/YOUR_USERNAME/projects/my-blog',

  // Path to editor files (usually __dirname)
  editorPath: __dirname,

  // Deploy command - runs after Hugo build
  // Examples:
  // deployCommand: './deploy.sh',
  // deployCommand: 'rsync -avz --delete public/ user@server:~/www/',
  // deployCommand: 'firebase deploy',
  deployCommand: null,  // Skip deployment (local only)
};
```

### Client Configuration (editor.js)

```javascript
const CONFIG = {
  // Your Hugo blog path (use absolute path, adjust to your setup)
  blogPath: '/Users/YOUR_USERNAME/projects/my-blog',

  // Your blog URL (for the "View Post" link after publishing)
  // Use localhost:1313 for local preview, or your live URL for production
  blogUrl: 'http://localhost:1313',

  // API endpoint (should match server port)
  apiUrl: 'http://localhost:3000'
};
```

---

## How It Works

### HTML to Markdown Conversion

The editor uses `contenteditable` for WYSIWYG editing. When you publish, the `htmlToMarkdown()` function converts HTML to Markdown:

| HTML | Markdown |
|------|----------|
| `<strong>text</strong>` | `**text**` |
| `<em>text</em>` | `*text*` |
| `<h2>Heading</h2>` | `## Heading` |
| `<ul><li>item</li></ul>` | `- item` |
| `<blockquote>text</blockquote>` | `> text` |
| `<a href="url">text</a>` | `[text](url)` |
| `<code>code</code>` | `` `code` `` |

### Front Matter Generation

The editor automatically generates Hugo front matter:

```yaml
---
title: "Your Post Title"
date: 2024-01-20T15:30:00.000Z
draft: false
tags: ["tag1", "tag2"]
---
```

### Slug Generation

Post filenames are generated from the title:
- "My First Blog Post" â†’ `my-first-blog-post.md`
- Special characters are removed
- Spaces become hyphens
- Limited to 60 characters

---

## Customization Guide

### Changing Colors (style.css)

Find the CSS variables at the top of `style.css`:

```css
:root {
  /* Light theme */
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --text-primary: #212529;
  --accent-color: #007bff;
  
  /* Change these to customize your theme */
}

@media (prefers-color-scheme: dark) {
  :root {
    /* Dark theme */
    --bg-primary: #1a1a1a;
    --text-primary: #e9ecef;
  }
}
```

### Changing Fonts (style.css)

```css
:root {
  /* System fonts */
  --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-serif: Georgia, "Times New Roman", serif;
  --font-mono: "SF Mono", Menlo, Monaco, monospace;
}
```

To use custom fonts:
```css
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

:root {
  --font-sans: 'Inter', sans-serif;
}
```

### Changing Editor Width (style.css)

```css
:root {
  --editor-max-width: 720px;  /* Change this */
}
```

### Adding Custom Toolbar Buttons (editor.js)

1. Add button to HTML in `index.html`:
```html
<button type="button" data-command="strikethrough" title="Strikethrough">SÌ¶</button>
```

2. Add command handler in `editor.js`:
```javascript
const toolbarCommands = {
  // ... existing commands ...
  strikethrough: () => document.execCommand('strikethrough'),
};
```

3. Update `htmlToMarkdown()` to handle the new format:
```javascript
case 's':
case 'strike':
  return `~~${children}~~`;
```

### Changing Auto-save Delay (editor.js)

```javascript
function initAutoSave() {
  // ...
  autoSaveTimeout = setTimeout(() => {
    // ...
  }, 2000);  // Change this value (milliseconds)
}
```

### Adding Image Support

This requires additional work:
1. Add file upload input to HTML
2. Handle file upload in server.js
3. Save images to `myblog/static/images/`
4. Insert Markdown image syntax

Example implementation available in Future Enhancements section.

---

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `âŒ˜B` | Bold |
| `âŒ˜I` | Italic |
| `âŒ˜S` | Save draft |
| `âŒ˜Enter` | Publish |

Browser defaults also work:
| Shortcut | Action |
|----------|--------|
| `âŒ˜Z` | Undo |
| `âŒ˜Shift+Z` | Redo |
| `âŒ˜A` | Select all |

---

## Troubleshooting

### "Server not running" when publishing

**Symptom**: File downloads instead of publishing

**Solution**: Start the server
```bash
cd ~/projects/omni-blogger  # Adjust to your editor location
node server.js
```

### Hugo build fails

**Symptom**: Error message about Hugo

**Check**:
1. Hugo is installed: `hugo version`
2. Blog path is correct in `server.js` (should point to your Hugo blog folder)
3. Your Hugo blog works: `cd ~/projects/my-blog && hugo`
4. A theme is installed: check `hugo.toml` has a `theme` entry

### Post not appearing on site

**Check**:
1. Post has `draft: false` in front matter
2. Hugo build completed successfully
3. Deploy command ran (check server console)
4. Clear browser cache

### Drafts disappeared

Drafts are stored in browser localStorage. They may be lost if you:
- Clear browser data
- Use a different browser
- Use incognito mode

**Future improvement**: Store drafts as files

### CORS errors in console

Make sure you're accessing the editor via:
```
http://localhost:3000
```
Not by opening the HTML file directly.

---

## Future Enhancements

Ideas for extending the editor:

### 1. Image Upload Support

```javascript
// Add to server.js
async function handleImageUpload(req, res) {
  // Save to myblog/static/images/
  // Return the image path
}
```

### 2. Preview Panel

Split view showing Markdown preview alongside editor.

### 3. File-based Drafts

Save drafts as files instead of localStorage:
```javascript
// Save to myblog/content/drafts/
```

### 4. Edit Existing Posts

Load posts from Hugo for editing:
```javascript
// GET /posts/:filename
// Returns the markdown content
```

### 5. Convert to Electron App

Package as a standalone Mac app:
```bash
npm install electron
# Create main.js for Electron
```

### 6. AI Summarization

Add button to summarize/polish content using Claude API.

### 7. Sync with Freewrite

Import entries from Freewrite app for editing/publishing.

---

## Quick Reference

### Start the Editor
```bash
cd ~/projects/omni-blogger && node server.js
# Open http://localhost:3000
```

### Start Hugo Preview (optional)
```bash
cd ~/projects/my-blog && hugo server
# Open http://localhost:1313
```

### File Locations

| What | Where |
|------|-------|
| Editor files | Where you installed omni-blogger |
| Blog posts | `<your-blog-path>/content/posts/` |
| Built site | `<your-blog-path>/public/` |
| Drafts | Browser localStorage |

### Workflow

```
Write in Editor â†’ Click Publish â†’ Hugo builds â†’ Preview at localhost:1313
```

---

## Support

This is a personal tool you own and control. For issues:

1. Check the Troubleshooting section
2. Check the browser console for errors
3. Check the server console for errors
4. Modify the code to fix issuesâ€”it's yours!

---

*Built for writers who want to own their content.*
